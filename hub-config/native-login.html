{% extends "page.html" %}

{% if announcement_login %}
  {% set announcement = announcement_login %}
{% endif %}

{% block script %}
{{ super() }}
<script type="text/javascript">
    document.addEventListener('DOMContentLoaded', function() {
        let button = document.getElementById('eye');
        button.addEventListener("click", function(e) {
            let pwd = document.getElementById("password_input");
            if (pwd.getAttribute("type") === "password") {
                pwd.setAttribute("type", "text");
                button.textContent = "Hide";
            } else {
                pwd.setAttribute("type", "password");
                button.textContent = "Show";
            }
        });
    });

    // Warning disabled for local development
    // if (window.location.protocol === "http:") {
    //     let warning = document.getElementById('insecure-login-warning');
    //     warning.className = warning.className.replace(/\bhidden\b/, '');
    // }
</script>
{% endblock script %}

{% block main %}
{% block login %}
<div id="login-main" class="container">
    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
        }
        #login-main {
            max-width: 480px;
            background: linear-gradient(145deg, #ffffff 0%, #f8f9fa 100%);
            padding: 40px;
            border-radius: 24px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3), 0 0 0 1px rgba(255,255,255,0.1);
            margin-top: 60px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
        }
        .auth-form-header {
            text-align: center;
            font-size: 32px;
            font-weight: 800;
            color: #667eea;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .auth-form-body label {
            font-weight: 600;
            color: #333;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 8px;
            display: block;
        }
        .auth-form-body .form-control {
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            padding: 12px 16px;
            font-size: 15px;
            transition: all 0.3s ease;
        }
        .auth-form-body .form-control:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
            outline: none;
        }
        .auth-form-body .input-group {
            position: relative;
        }
        .auth-form-body .input-group-addon {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
        }
        .auth-form-body .input-group-addon button {
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            padding: 0;
            transition: transform 0.2s;
        }
        .auth-form-body .input-group-addon button:hover {
            transform: scale(1.2);
        }
        .form-actions {
            text-align: center;
            margin-top: 24px;
        }
        .form-actions .btn {
            min-width: 200px;
            padding: 14px 28px;
            font-size: 16px;
            font-weight: 700;
            border-radius: 12px;
            border: none;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #fff;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            text-transform: uppercase;
            letter-spacing: 1px;
            cursor: pointer;
        }
        .form-actions .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.5);
        }
        .form-actions .btn:active {
            transform: translateY(0);
        }
        #login-main hr {
            border: 0;
            height: 1px;
            background: linear-gradient(to right, transparent, #e0e0e0, transparent);
            margin: 24px 0;
        }
        #login-main a {
            color: #667eea;
            font-weight: 600;
            text-decoration: none;
            transition: color 0.2s;
        }
        #login-main a:hover {
            color: #764ba2;
            text-decoration: underline;
        }
        .login_error {
            background: #fee;
            border: 2px solid #f88;
            border-radius: 12px;
            padding: 12px;
            color: #c33;
            font-weight: 600;
            margin-bottom: 16px;
        }
        #insecure-login-warning {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 12px;
            padding: 12px;
            color: #856404;
            margin-bottom: 16px;
        }
    </style>
    <form action="{{login_url}}?next={{next}}" method="post" role="form">
        <div class="auth-form-header">
            Sign In
        </div>

        <div class='auth-form-body' style="margin-top: 24px;">
            <p id='insecure-login-warning' class='hidden'>
                Warning: JupyterHub seems to be served over an unsecured HTTP connection.
                We strongly recommend enabling HTTPS for JupyterHub.
            </p>

            {% if login_error %}
            <p class="login_error">
                {{login_error}}
            </p>
            {% endif %}
            <input type="hidden" name="_xsrf" value="{{ xsrf }}"/>
            <label for="username_input">Username:</label>
            <input id="username_input" type="text" name="username" val="{{username}}" autocapitalize="off" autocorrect="off" class="form-control" autofocus="autofocus" required />
            <p></p>

            <label for="password_input">Password:</label>
            <div class="input-group">
                <input id="password_input" type="password" name="password" val="" autocapitalize="off" autocorrect="off" class="form-control" />
                <span class="input-group-addon">
                    <button id="eye" type="button" style="border:0;">Show</button>
                </span>
            </div>
            <p></p>

            {% if two_factor_auth %}
            <label for="2fa_input">2FA code:</label>
            <input id="2fa_input" type="text" autocapitalize="off" autocorrect="off" class="form-control" name="2fa" placeholder="If you don't have 2FA, leave empty" />
            <p></p>
            {% endif %}

            <div class="form-actions">
                <input type="submit" id="login_submit" class='btn' value='Sign In' />
            </div>
            <p></p>

            {% if enable_signup %}
            <hr />
            <p class="text-center">
                <a href="{{ base_url }}signup">Sign up</a> to create a new user.
            </p>
            {% endif %}
        </div>
    </form>
</div>
{% endblock login %}
{% endblock main %}
