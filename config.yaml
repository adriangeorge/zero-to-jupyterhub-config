hub:
  db:
    type: sqlite-pvc
    pvc:
      storageClassName: standard
      storage: 1Gi
  templatePaths:
    - /usr/local/etc/jupyterhub/hub-config
  
  resources:
    requests:
      cpu: 200m
      memory: 1Gi
    limits:
      cpu: 2
      memory: 2Gi
  
  config:
    JupyterHub:
      authenticator_class: nativeauthenticator.NativeAuthenticator
      admin_access: true
      default_url: /hub/home
      redirect_to_server: false
      load_groups:
        admins:
          users:
            - admin
        teacher-prof-smith:
          users:
            - prof_smith
        teacher-prof-jones:
          users:
            - prof_jones
        teacher-prof-doe:
          users:
            - prof_doe
        teachers:
          users:
            - prof_smith
            - prof_jones
            - prof_doe
      load_roles:
        - name: teacher
          scopes:
            - self
            - admin:servers  # Can access all user servers
            - access:servers  # Can access servers via browser
            - list:users  # Can list users
            - read:users:name  # Can read user names
            - read:users:groups  # Can read user groups
            - read:users:activity  # Can read user activity
            - read:servers  # Can read server info
          groups:
            - teachers
    
    NativeAuthenticator:
      enable_signup: true
      ask_email_on_signup: true
      open_signup: false
      minimum_password_length: 8
      check_common_password: true
      template_paths:
        - /usr/local/etc/jupyterhub/hub-config
    
    Authenticator:
      admin_users:
        - admin
      allow_all: true
  
  extraVolumes:
    - name: hub-config-modules
      configMap:
        name: hub-config-modules
  
  extraVolumeMounts:
    - name: hub-config-modules
      mountPath: /usr/local/etc/jupyterhub/hub-config
      readOnly: true
  
  extraConfig:
    00-install-nativeauth: |
      exec(open('/usr/local/etc/jupyterhub/hub-config/00_install_nativeauth.py').read())
    
    01-custom-home-handler: |
      exec(open('/usr/local/etc/jupyterhub/hub-config/01_custom_home_handler.py').read())
      register_handler(c)
    
    02-my-students-handler: |
      exec(open('/usr/local/etc/jupyterhub/hub-config/02_my_students_handler.py').read())
      register_handler(c)
    
    03-load-native-handlers: |
      exec(open('/usr/local/etc/jupyterhub/hub-config/03_load_native_handlers.py').read())
      register_handlers(c)
    
    04-custom-spawner: |
      exec(open('/usr/local/etc/jupyterhub/hub-config/04_custom_spawner.py').read())
      configure_spawner(c)
    
    05-student-auto-auth: |
      exec(open('/usr/local/etc/jupyterhub/hub-config/05_student_auto_auth.py').read())
      configure_auth_hook(c)
    
    07-student-enrollment: |
      exec(open('/usr/local/etc/jupyterhub/hub-config/07_student_enrollment.py').read())
      register_handler(c)
    
    08-custom-admin-panel: |
      exec(open('/usr/local/etc/jupyterhub/hub-config/08_custom_admin_panel.py').read())
      register_handler(c)
    
    10-manage-groups: |
      exec(open('/usr/local/etc/jupyterhub/hub-config/10_manage_groups.py').read())
      register_handler(c)

singleuser:
  nodeSelector:
    kubernetes.io/hostname: minikube
  storage:
    type: dynamic
    capacity: 1Gi
    dynamic:
      storageClass: standard
    extraVolumes:
      - name: shared-datasets
        persistentVolumeClaim:
          claimName: shared-datasets-pvc
    extraVolumeMounts:
      - name: shared-datasets
        mountPath: /home/jovyan/shared-data
        readOnly: true
  
  profileList:
    - display_name: "Student Environment"
      description: "Default environment for students"
      default: true
      kubespawner_override:
        cpu_limit: 1.0
        cpu_guarantee: 0.5
        mem_limit: "2G"
        mem_guarantee: "1G"
        image: quay.io/jupyterhub/k8s-singleuser-sample:3.3.8
